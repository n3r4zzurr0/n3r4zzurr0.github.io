const videoFrames=async t=>{var e,o=0,n=!1,i=!1;const r=[],s=t=>+t+""==t+"",a=t=>s(t)&&+t>=0&&+t<=m.duration,h=(t,e)=>e instanceof t,d=(e,o)=>{t[e]=c.call(t,e)?t[e]:o},c=Object.prototype.hasOwnProperty,m=document.createElement("video");for(m.src=t.url,m.crossOrigin="anonymous",m.onseeked=(async()=>{e&&e()}),m.onerror=(()=>{n=!0});(m.duration===1/0||isNaN(m.duration))&&m.readyState<2&&(await new Promise(t=>setTimeout(t,100)),m.currentTime=1e7*Math.random(),!n););d("format","image/png"),d("offsets",[]),d("startTime",0),d("endTime",m.duration),d("count",1),d("onLoad",!1),d("onProgress",!1),h(Array,t.offsets)?t.offsets=t.offsets.filter(t=>a(t)):t.offsets=[],0!==t.offsets.length&&(i=!0),a(t.startTime)||(t.startTime=0),a(t.endTime)||(t.endTime=m.duration),t.startTime>=t.endTime&&(t.startTime=t.endTime,t.count=1),t.count=Math.abs(~~t.count),0===t.count&&(t.count=1),i&&(t.count=t.offsets.length);const u=(t.endTime-t.startTime)/t.count;var g=c.call(t,"width"),f=c.call(t,"height"),w=m.videoWidth/m.videoHeight;g&&!s(t.width)&&(g=!1),f&&!s(t.height)&&(f=!1),g||f?g&&!f?t.height=t.width/w:!g&&f&&(t.width=t.height*w):(t.width=128,t.height=t.width/w),t.width=+t.width,t.height=+t.height,h(Function,t.onLoad)||(t.onLoad=!1),h(Function,t.onProgress)||(t.onProgress=!1),t.onLoad&&t.onLoad();const T=document.createElement("canvas"),l=T.getContext("2d");T.width=t.width,T.height=t.height;return new Promise(s=>{n&&s([]),(async n=>{for(;o<t.count;)m.currentTime=i?t.offsets[o]:t.startTime+o*u,await new Promise(t=>{e=t}),l.clearRect(0,0,T.width,T.height),l.drawImage(m,0,0,T.width,T.height),r.push({offset:m.currentTime,image:T.toDataURL(t.format)}),o++,t.onProgress&&t.onProgress(o,t.count);n(r)})(s)})};
